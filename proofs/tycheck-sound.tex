\begin{proof}
We prove both claims simultaneously by induction over $\Psi;\Theta;\Delta;\Omega;\Gamma \vdash e \checks \tau \gens \Phi, \Gamma'$ and $\Psi;\Theta;\Delta;\Omega;\Gamma \vdash e \infers \tau \gens \Phi, \Gamma'$.
We will often use Theorem~\ref{thm:lsc} and Theorem~\ref{thm:ctx-sub-subset-1} silently, usually baked into calls to weakening.
\begin{enumerate}
  \item[AT-Var-1] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash x \infers \tau \gens \top, \Gamma \setminus \{x : \tau\}$ by way of $x : \tau \in \Gamma$. Clearly, $x : \tau \in \{x : \tau\}$, and so by T-Var-1, $\Psi ; \Theta ; \Delta ; \Omega ; x : \tau \vdash x : \tau$, as required.
  \item[AT-Var-2] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash x \infers \tau \gens \top, \Gamma$ by way of $x : \tau \in \Omega$. Then, by T-Var-2, $\Psi ; \Theta ; \Delta ; \Omega ; \cdot \vdash x : \tau$ as required.
  
  \item[AT-Unit] Immediate. 
  \item[AT-Base] Immediate. 
  \item[AT-Absurd] Immediate. 
  \item[AT-Nil] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash \texttt{nil} \checks L^I \tau \gens I = 0, \Gamma$  with $\Theta ; \Delta \vDash I = 0$. Then, by T-Nil, $\Psi ; \Theta ; \Delta ; \Omega ; \cdot \vdash \texttt{nil} : L^0 \tau$. By S-List and S-Refl, $\Psi ; \Theta ; \Delta \vdash L^0 \tau \subty L^I \tau : \star$. By T-Sub, $\Psi ; \Theta ; \Delta ; \Omega ; \cdot \vdash \texttt{nil} : L^I \tau$, as required.
 
  
  \item[AT-Cons] 
  \textbf{REDO THIS CASE}  
  Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash e_1 :: e_2 \checks L^I \tau \gens (I \geq 1) \wedge \Phi_1 \wedge \Phi_2, \Gamma_2$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash e_1 \checks \tau \gens \Phi_1, \Gamma_1$ and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1\vdash e_2 \checks L^{I-1} \tau \gens \Phi_2, \Gamma_2$ with $\Theta ; \Delta \vDash I \geq 1$, $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta \vDash \Phi_2$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e_1| : \tau$, and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1 \setminus \Gamma_2 \vdash e_2 : L^{I-1} \tau$. Then, because $\Theta ; \Delta \vDash I \geq 1$, by T-Weaken and T-Cons, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_2 \vdash |e_1 :: e_2| : L^I \tau$.
  
  \item[AT-Match] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash \texttt{match}(e,e_1,h.t.e_2) \checks \tau' \gens \Phi_1 \wedge \Phi_\texttt{body}, \Gamma'$ from:
  \begin{enumerate}
    \item $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash e \infers L^I \tau \gens \Phi_1, \Gamma_1$
    \item $\Psi ; \Theta ; \Delta, I = 0 ; \Omega ; \Gamma_1\vdash e_1 \checks \tau' \gens \Phi_2,\Gamma_2$
    \item $\Psi ; \Theta ; \Delta, I \geq 1; \Omega ; \Gamma_1, h : \tau, t : L^{I-1} \tau \vdash e_2 \checks \tau' \gens \Phi_3,\Gamma_3$
  \end{enumerate}
  with $\Phi_\texttt{body} = (I = 0 \to \Phi_2) \wedge (I \geq 1 \to \Phi_3 )$, $\Gamma' = \Gamma_2 \cap (\Gamma_3 \setminus \{h,t\})$, and $\Theta ; \Delta \vDash \Phi_1$, $\Theta ; \Delta, I = 0 \vDash \Phi_2$, and $\Theta ; \Delta, I \geq 1 \vDash \Phi_3$. Then, by IH we have:
  \begin{enumerate}
    \item $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e| : L^I \tau$
    \item $\Psi ; \Theta ; \Delta, I = 0 ; \Omega ; \Gamma_1 \setminus \Gamma_2 \vdash |e_1| : \tau'$
    \item $\Psi ; \Theta ; \Delta, I \geq 1; \Omega ; (\Gamma_1, h : \tau, t : L^{I-1} \tau) \setminus \Gamma_3 \vdash |e_2| : \tau'$
  \end{enumerate}
  Then, by T-weakening, we have that $\Psi ; \Theta ; \Delta, I = 0 ; \Omega ; \Gamma_1 \setminus \Gamma' \vdash |e_1| : \tau'$ and $\Psi ; \Theta ; \Delta, I \geq 1; \Omega ; \Gamma_1 \setminus \Gamma', h : \tau, t : L^{I-1} \tau \vdash |e_2| : \tau'$. Then, by T-match and one more T-weakening,
  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |\texttt{match}(e,e_1,h.t.e_2)| : \tau'$ as required.
  
  \item[AT-ExistI] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash \texttt{pack}[I](e) \checks \exists i:S.\tau \gens \Phi_1 \wedge \Phi_2, \Gamma'$ by way of $\Theta ; \Delta \vdash I : S \gens \Phi_1$ and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash e \checks \tau[I/i] \gens \Phi_2,\Gamma'$, with $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta \vDash \Phi_2$. By \textbf{Soundness of Sort Checking},  $\Theta ; \Delta \vdash I : S$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\setminus \Gamma' \vdash |e| \checks \tau[I/i]$. By T-ExistI, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma'\vdash |\texttt{pack}[I](e)| : \exists i:S.\tau$, as required.

  \item[AT-ExistE] Suppose ${
\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash \texttt{unpack } (i,x) = e \texttt{ in } e' \checks \tau' \gens \Phi , \Gamma_2 \setminus \{x\}
}$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash e \infers \exists i : S.\tau \gens \Phi_1, \Gamma_1$ and $\Psi ; \Theta, i : S ; \Delta ; \Omega ; \Gamma_1, x : \tau \vdash e' \checks \tau' \gens \Phi_2, \Gamma_2$ with $\Phi = \Phi_1 \wedge (\forall i : S. \Phi_2)$ and $\Theta ; \Delta \vDash \Phi_1$, $\Theta ; \Delta \vDash \forall i : S. \Phi_2$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash e : \exists i : S.\tau$. Since $\Theta, i :S ; \Delta \vDash \Phi_2$, we have by IH that $\Psi ; \Theta, i : S ; \Delta ; \Omega ; (\Gamma_1, x : \tau) \setminus \Gamma_2 \vdash e' : \tau'$. By weakening, $\Psi ; \Theta, i : S ; \Delta ; \Omega ; (\Gamma_1 \setminus (\Gamma_2 \setminus \{x : \tau\})), x : \tau \vdash e' : \tau'$, and so by T-ExistE, $
\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma \setminus \Gamma_1), (\Gamma_1 \setminus (\Gamma_2 \setminus \{x : \tau\})) \vdash |\texttt{unpack } (i,x) = e \texttt{ in } e'| : \tau'$, and hence by weakening, ${
\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus (\Gamma_2 \setminus \{x : \tau\})\vdash |\texttt{unpack } (i,x) = e \texttt{ in } e'| : \tau'
}$ as required.
  \item[AT-Lam] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash \lambda x.e \checks \tau_1 \loli \tau_2 \gens \Phi, \Gamma' \setminus \{x : \tau_1\}$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma, x : \tau_1 \vdash e \checks \tau_2, \gens \Phi, \Gamma'$, with $\Theta ; \Delta \vDash \Phi$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma, x : \tau_1) \setminus \Gamma' \vdash e : \tau_2$. By weakening,  $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma \setminus (\Gamma' \setminus \{x : \tau_1\})), x : \tau_1 \vdash e : \tau_2$. Then, by T-Lam,  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus (\Gamma' \setminus \{x : \tau_1\}) \vdash \lambda x.e : \tau_1 \loli \tau_2$ as required.
  \item[AT-App] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash e_1 \, e_2 \infers  \tau_2 \gens \Phi_1 \wedge \Phi_2, \Gamma_2
$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash e_1 \infers \tau_1 \loli \tau_2 \gens \Phi_1, \Gamma_1$ and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1\vdash e_2 \checks \tau_1 \gens \Phi_2, \Gamma_2$ with $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta \vDash \Phi_2$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e_1| : \tau_1 \loli \tau_2$, and also by IH $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1 \setminus \Gamma_2 \vdash |e_2| : \tau_1$, and so by T-App, $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma \setminus \Gamma_1),(\Gamma_1 \setminus \Gamma_2)\vdash |e_1 \, e_2| :  \tau_2$. Then, by weakening,  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_2\vdash |e_1 \, e_2| :  \tau_2$ as required.
  \item[AT-TensorI] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash \angles{e_1,e_2} \checks \tau_1 \otimes \tau_2 \gens \Phi_1 \wedge \Phi_2,\Gamma_2$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash e_1 \checks \tau_1 \gens \Phi_1, \Gamma_1$ and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1\vdash e_2 \checks \tau_2 \gens \Phi_2, \Gamma_2$ with $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta \vDash \Phi_2$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e_1| : \tau_1$. Also by IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1 \setminus \Gamma_2 \vdash |e_2| : \tau_2$. By T-TensorI and weakening, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_2\vdash |\angles{e_1,e_2}| : \tau_1 \otimes \tau_2$.
  \item[AT-TensorE] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash \texttt{let } \angles{x,y} = e \texttt{ in } e' \checks \tau' \gens \Phi_1 \wedge \Phi_2, \Gamma_2 \setminus \{x : \tau_1,y : \tau_2\}$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\vdash e \infers \tau_1 \otimes \tau_2 \gens \Phi_1, \Gamma_1$ and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1,x : \tau_1, y : \tau_2\vdash e' \checks \tau' \gens \Phi_2,\Gamma_2$ with $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta\vDash \Phi_2$. By two uses of the IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e| : \tau_1 \otimes \tau_2$ and $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma_1,x : \tau_1, y : \tau_2) \setminus \Gamma_2 \vdash |e'| : \tau'$. By weakening, $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma_1 \setminus (\Gamma_2 \setminus \{x : \tau_1, y : \tau_2\})),x : \tau_1, y : \tau_2\ \vdash |e'| : \tau'$. By T-TensorE and weakening, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\setminus (\Gamma_2 \setminus \{x : \tau_1,y : \tau_2\}) \vdash |\texttt{let } \angles{x,y} = e \texttt{ in } e'| : \tau'$
  \item[AT-WithI] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash (e_1,e_2) \checks \tau_1 \amp \tau_2 \gens \Phi_1 \wedge \Phi_2, \Gamma_1 \cap \Gamma_2$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e_1 \checks \tau_1 \gens \Phi_1, \Gamma_1$ and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e_2 \checks \tau_2 \gens \Phi_2, \Gamma_2$ with $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta \vDash \Phi_2$. By applying the IH twice, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e_1| : \tau_1$, and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_2 \vdash |e_2| : \tau_2$. By T-WithI and weakening,
$\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus (\Gamma_1 \cap \Gamma_2)\vdash (e_1,e_2) : \tau_1 \amp \tau_2$
  \item[AT-Fst] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{fst}(e) \infers \tau_1 \gens \Phi,\Gamma'$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \infers \tau_1 \amp \tau_2 \gens \Phi,\Gamma'$ with $\Theta ; \Delta \vDash \Phi$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| \infers \tau_1 \amp \tau_2$, and by T-Fst, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash \texttt{fst}(e) : \tau_1$
  \item[AT-Snd] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{snd}(e) \infers \tau_2 \gens \Phi,\Gamma'$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \infers \tau_1 \amp \tau_2 \gens \Phi,\Gamma'$ with $\Theta ; \Delta \vDash \Phi$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| \infers \tau_1 \amp \tau_2$, and by T-Snd, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash \texttt{snd}(e) : \tau_2$
  \item[AT-Inl] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{inl}(e) \checks \tau_1 \oplus \tau_2 \gens \Phi,\Gamma'$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \checks \tau_1 \gens \Phi,\Gamma'$ with $\Theta ; \Delta \vDash \Phi$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \tau_1$. By T-Inl,  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |\texttt{inl}(e)| : \tau_1 \oplus \tau_2$ as required.
  \item[AT-Inr] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{inr}(e) \checks \tau_1 \oplus \tau_2 \gens \Phi,\Gamma'$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \checks \tau_2 \gens \Phi,\Gamma'$ with $\Theta ; \Delta \vDash \Phi$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \tau_2$. By T-Inr,  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |\texttt{inr}(e)| : \tau_1 \oplus \tau_2$ as required.
  \item[AT-Case] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{case}(e,x.e_1,y.e_2) \checks \tau \gens \Phi_1 \wedge \Phi_2 \wedge \Phi_3, \Gamma'$ by way of
  \begin{itemize}
    \item $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \infers \tau_1 \oplus \tau_2 \gens \Phi_1, \Gamma_1$
    \item $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1, x: \tau_1 \vdash e_1 \checks \tau \gens \Phi_2,\Gamma_2$
    \item $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1, y: \tau_2 \vdash e_2 \checks \tau \gens \Phi_3,\Gamma_3$
  \end{itemize}
  with $\Theta ; \Delta \vDash \Phi_i$, $i \in \{1,2,3\}$ . By IH, we have that
  \begin{itemize}
    \item $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e| : \tau_1 \oplus \tau_2$
    \item $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma_1, x: \tau_1) \setminus \Gamma_2 \vdash |e_1| : \tau$
    \item $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma_1, y: \tau_2) \setminus \Gamma_2 \vdash |e_2| : \tau$
  \end{itemize}
  By T-weakening, we get that $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1 \setminus \Gamma', x : \tau_1 \vdash |e_1| : \tau$ and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1 \setminus \Gamma', y : \tau_2 \vdash |e_2| : \tau$. So, by T-Case and another T-Weakening, we have that
  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |\texttt{case}(e,x.e_1,y.e_2)| : \tau$ as required.
  
  \item[AT-ExpI] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash !e \checks !\tau \gens \Phi, \Gamma$ from $\Psi ; \Theta ; \Delta ; \Omega ; \cdot \vdash e \checks \tau \gens \Phi, \Gamma'$ with $\Theta ; \Delta \vDash \Phi$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \cdot \vdash e : \tau$, and then by T-ExpI, $\Psi ; \Theta ; \Delta ; \Omega ; \cdot \vdash !e : !\tau$ as required.
  \item[AT-ExpE] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{let } !x = e \texttt{ in } e' \checks \tau' \gens \Phi_1 \wedge \Phi_2, \Gamma_2$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \infers !\tau \gens \Phi_1,\Gamma_1$ and $\Psi ; \Theta ; \Delta ; \Omega, x : \tau ; \Gamma_1 \vdash e' \checks \tau' \gens \Phi_2,\Gamma_2$. 
  \item[AT-TAbs] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \Lambda \alpha. e \checks \forall \alpha : K.\tau \gens \Phi,\Gamma'$ by way of $\Psi, \alpha : K ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \checks \tau \gens \Phi, \Gamma'$ with $\Theta ; \Delta \vDash \Phi$. By IH,  $\Psi, \alpha : K ; \Theta ; \Delta ; \Omega ; \Gamma\setminus \Gamma' \vdash |e| : \tau$. By T-TAbs, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |\Lambda \alpha. e| : \forall \alpha : K.\tau$ as required.
  
  \item[AT-TApp] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e [\tau'] \infers \tau[\tau'/\alpha] \gens \Phi_1 \wedge \Phi_2, \Gamma'$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \infers \forall \alpha : K.\tau \gens \Phi_1, \Gamma'$ and $\Psi ; \Theta ; \Delta \vdash \tau' : K \gens \Phi_2$, with $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta \vDash \Phi_2$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \forall \alpha : K.\tau$. By \textbf{Soundness of Kind Checking}, $\Psi ; \Theta ; \Delta \vdash \tau' : K$. So, by T-TApp,  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\setminus \Gamma' \vdash |e [\tau']| : \tau[\tau'/\alpha]$ as required.
  
  \item[AT-IAbs]
  Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \Lambda i. e \checks \forall i : S. \tau \gens \forall i : S. \Phi, \Gamma'$ by way of $\Psi ; \Theta, i : S ; \Delta ; \Omega ; \Gamma \vdash e \checks \tau \gens \Phi, \Gamma'$ with $\Theta ; \Delta \vDash \forall i : S. \Phi$. Equivalently, $\Theta , i : S; \Delta \vDash \Phi$, and so by IH, $\Psi ; \Theta, i : S ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \tau$. By T-IAbs, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\setminus \Gamma' \vdash |\Lambda i. e| : \forall i : S. \tau$ as required.
  
  \item[AT-IApp] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e [I] \infers \tau[I/i] \gens \Phi_1 \wedge \Phi_2,\Gamma'$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \infers \forall i : S.\tau \gens \Phi_1,\Gamma'$ and $\Theta ; \Delta \vdash I : S \gens \Phi_2$ with $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta \vDash \Phi_2$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \forall i : S.\tau$, and by \textbf{Soundness of Sort Checking}, $\Theta ; \Delta \vdash I : S$. Then, by T-IApp, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\setminus \Gamma' \vdash |e [I]| : \tau[I/i]$ as required.
  
  \item[AT-Fix] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{fix } x.e \checks \tau \gens \Phi,\Gamma$ by way of $\Psi ; \Theta ; \Delta ; \Omega, x : \tau ; \cdot \vdash e \checks \tau \gens \Phi,\Gamma'$ with $\Theta ; \Delta \vDash \Phi$. By IH, $\Psi ; \Theta ; \Delta ; \Omega, x : \tau ; \cdot \vdash |e| : \tau$. By T-Fix, $\Psi ; \Theta ; \Delta ; \Omega ; \cdot \vdash |\texttt{fix } x.e| : \tau$ as required.
  
  \item[AT-Ret] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{ret } e \checks \M \, \phi(I,\vec{p}) \, \tau \gens \Phi, \Gamma'$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \checks \tau \gens \Phi,\Gamma'$ with $\Theta ; \Delta \vDash \Phi$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \tau$. By T-Ret, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |\texttt{ret } e| : \M \, \phi(I,\vec{p}) \, \tau$  as required.
  
  \item[AT-Bind] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{bind } x = e_1 \texttt{ in } e_2 \checks \M \, \phi(I,\vec{q})\, \tau_2 \gens \Phi, \Gamma_2 \setminus \{x : \tau_1\}$ by way of
  \begin{itemize}
    \item $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e_1 \infers \M \, \phi(J,\vec{p})\, \tau_1 \gens \Phi_1,\Gamma_1$
    \item $\Psi ; \Theta; \Delta ; \Omega ; \Gamma_1, x:\tau_1 \vdash e_2 \checks \M \, \phi(I,\vec{q} - \vec{p})\, \tau_2 \gens \Phi_2,\Gamma_2$
  \end{itemize}
  with $\Phi = (\vec{q} \geq \vec{p}) \wedge (I =J)  \wedge \Phi_1 \wedge \Phi_2$ and $\Theta ; \Delta \vDash \Phi$. By IH, we have that:
  \begin{itemize}
    \item $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e_1| : \M \, \phi(J,\vec{p})\, \tau_1$
    \item $\Psi ; \Theta; \Delta ; \Omega ; (\Gamma_1, x:\tau_1) \setminus \Gamma_2 \vdash |e_2| : \M \, \phi(I,\vec{q} - \vec{p})\, \tau_2$
  \end{itemize}
  Since $\Theta ; \Delta \vDash I = J$, $\Psi ; \Theta ; \Delta \vdash M(J,\vec{p})\, \tau_1 \subty M(I,\vec{p}) \, \tau_1 \; : \star$, we have by T-Sub that
  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e_1| : \M \, \phi(I,\vec{p})\, \tau_1$. By T-Weaken,
  $\Psi ; \Theta; \Delta ; \Omega ; (\Gamma_1 \setminus (\Gamma_2 \setminus \{x\})), x:\tau_1 \vdash |e_2| : \M \, \phi(I,\vec{q} - \vec{p})\, \tau_2$, and so by T-Bind, T-Weaken, and T-Sub (with $\Theta ; \Delta \vDash \vec{p} + \vec{q} - \vec{p} = \vec{q}$), we have that
  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus (\Gamma_2 \setminus \{x : \tau_1\}) \vdash |\texttt{bind } x = e_1 \texttt{ in } e_2| : \M \, \phi(I,\vec{q})\, \tau_2$ as required.
  
  \item[AT-Tick] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{tick}[I|\vec{p}] \infers \M \, \phi(I,\vec{p})\, 1 \gens \Phi_1 \wedge \Phi_2,\Gamma$ from $\Theta ; \Delta \vdash I : \N \gens \Phi_1$ and $\Theta ; \Delta \vdash \vec{p} : \vec{\mathbb{R}^+} \gens \Phi_1$ with $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta \vDash \Phi_2$. By \textbf{Soundness of Sort checking}, $\Theta ; \Delta \vdash I : \N$ and $\Theta ; \Delta \vdash \vec{p} : \vec{\mathbb{R}^+}$. Then, by T-Tick, $\Psi ; \Theta ; \Delta ; \Omega ; \cdot \vdash |\texttt{tick}[I|\vec{p}]| : \M \, \phi(I,\vec{p})\, 1$ as required.
  
  \item[AT-Release] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{release } x = e_1 \texttt{ in }e_2 \checks \M \, \phi(I,\vec{p}) \, \tau_2 \gens (I = J \wedge \Phi_1 \wedge \Phi_2), \Gamma_2 \setminus \{x : \tau_1\}$ from $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e_1 \infers [J | \vec{q}] \tau_1 \gens \Phi_1,\Gamma_1$ and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1, x : \tau_1 \vdash e_2 \checks \M \, \phi(I,\vec{p} + \vec{q}) \, \tau_2 \gens \Phi_2, \Gamma_2$ with $\Theta ;  \Delta \vDash \Phi_i$ and $\Theta ; \Delta \vDash I = J$. By IH, we have that $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e_1| : [J | \vec{q}] \tau_1$  and $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma_1, x : \tau_1) \setminus \Gamma_2 \vdash |e_2| : \M \, \phi(I,\vec{p} + \vec{q}) \, \tau_2$. Since $\Theta ; \Delta \vDash I = J$, we have that $\Psi ; \Theta ; \Delta \vdash [J|\vec{q}] \tau_1 \subty [I|\vec{q}] \tau_1 : \star$, and so by T-Sub, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e_1| : [I | \vec{q}] \tau_1$. By T-Weaken, we have that $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma_1 \setminus (\Gamma_2 \setminus \{x : \tau_1\})) , x : \tau_1 \vdash |e_2| : \M \, \phi(I,\vec{p} + \vec{q}) \, \tau_2$. Then, by T-Release and one more T-Weaken, we have that $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus (\Gamma_2 \setminus \{x : \tau_1\}) \vdash |\texttt{release } x = e_1 \texttt{ in }e_2| : \M \, \phi(I,\vec{p}) \, \tau_2$
  \item[AT-Store] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{store}[K|\vec{w}](e) \checks \M \, \phi(I,\vec{q}) \, ([J | \vec{p}] \, \tau) \gens \Phi, \Gamma'$ from
  \begin{itemize}
    \item $\Theta ; \Delta \vdash K : \N \gens \Phi_1$
    \item $\Theta ; \Delta \vdash \vec{w} : \vec{\mathbb{R}^+} \gens \Phi_2$
    \item $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \checks \tau \gens \Phi_3,\Gamma'$
  \end{itemize}
  with $\Phi =  \Phi_1 \wedge \Phi_2 \wedge\Phi_3 \wedge  (\vec{p} \leq \vec{w} \leq \vec{q}) \wedge (I = J = K)$
  and $\Theta ; \Delta \vDash \Phi$. By \textbf{soundness of sort checking}, $\Theta ; \Delta \vdash K : \N$ and $\Theta ; \Delta \vdash \vec{w} : \vec{\mathbb{R}^+}$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \tau$. By T-Store,
   $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash |\texttt{store}[K|\vec{w}](e)| : \M \, \phi(K,\vec{w}) \, ([K | \vec{w}] \, \tau)$. Then, since $\Theta ; \Delta \vDash \vec{p} \leq \vec{w} \leq \vec{q}$ and $\Theta ; \Delta \vDash I = J = K$ we have by T-Sub that $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash |\texttt{store}[K|\vec{w}](e)| : \M \, \phi(I,\vec{q}) \, ([J | \vec{p}] \, \tau)$, as required.
  
  \item[AT-StoreConst] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{store}[J](e) \checks \M \, \phi(K,\vec{p}) \, ([I] \, \tau) \gens \Phi, \Gamma'$ from $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \checks \tau \gens \Phi_1,\Gamma'$ and
 $\Theta ; \Delta \vdash J \checks \mathbb{R} \gens \Phi_2$ 
 with $\Phi = (\texttt{const}(I) \leq \texttt{const}(J) \leq \vec{p}) \wedge \Phi_1 \wedge \Phi_2$ 
 and $\Theta ; \Delta \vDash \Phi$. 
 By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \tau$.  By \textbf{soundness of sort checking}, $\Theta ; \Delta \vdash J : \mathbb{R}$. By T-StoreConst, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |\texttt{store}[J](e)| : \M \, \phi(K,\texttt{const}(J)) \, ([J] \, \tau)$. Because $\Theta ; \Delta \vDash \texttt{const}(I) \leq \texttt{const}(J) \leq \vec{p}$, we have by T-Sub that
 $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |\texttt{store}[J](e)| : \M \, \phi(K,\vec{p}) \, ([I] \, \tau)$, as required.
  
  \item[AT-ReleaseConst] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{release } x = e_1 \texttt{ in }e_2 \checks \M \, \phi(I,\vec{p}) \, \tau_2 \gens \Phi_1 \wedge \Phi_2, \Gamma_2 \setminus \{x\}$
  from $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e_1 \infers [J] \tau_1 \gens \Phi_1,\Gamma_1$
  and $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma_1, x : \tau_1 \vdash e_2 \checks \M \, \phi(I,\vec{p} + \texttt{const}(J)) \, \tau_2 \gens \Phi_2, \Gamma_2$
  with $\Theta ; \Delta \vDash \Phi_1 \wedge \Phi_2$.
  By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e_1| : [J] \tau_1$
  and $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma_1, x : \tau_1) \setminus \Gamma_2 \vdash |e_2| : \M \, \phi(I,\vec{p} + \texttt{const}(J)) \, \tau_2$. By T-Weaken,
  $\Psi ; \Theta ; \Delta ; \Omega ; (\Gamma_1 \setminus (\Gamma_2 \setminus \{x : \tau_1\})), x :\tau_1\vdash |e_2| : \M \, \phi(I,\vec{p} + \texttt{const}(J)) \, \tau_2$. By T-ReleaseConst and T-Weaken, 
  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus (\Gamma_2 \setminus \{x\}) \vdash |\texttt{release } x = e_1 \texttt{ in }e_2| : \M \, \phi(I,\vec{p}) \, \tau_2$

  \item[AT-Shift] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{shift}(e) \checks M \, \phi(I,\vec{q}) \, \tau \gens (I \geq 1) \wedge \Phi, \Gamma'$ from $\Psi ; \Theta ; \Delta  ; \Omega ; \Gamma \vdash e \checks M \, \phi(I - 1,\lhd \vec{q}) \, \tau \gens \Phi, \Gamma'$ with $\Theta ; \Delta \vDash \Phi$ and $\Theta ; \Delta \vDash  \geq 1$. By IH, $\Psi ; \Theta ; \Delta  ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : M \, \phi(I - 1,\lhd \vec{q}) \, \tau$. Since $\Theta ; \Delta \vDash I \geq 1$, we have by T-Shift that $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |\texttt{shift}(e)| : M \, \phi(I,\vec{q}) \, \tau$ as required.
  
  \item[AT-CImpI] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \Lambda .e \checks (\Phi' \Rightarrow \tau) \gens (\Phi' \to \Phi),\Gamma'$ from $\Psi ; \Theta ; \Delta,\Phi' ; \Omega ; \Gamma \vdash e \checks \tau \gens \Phi,\Gamma'$ with $\Theta ; \Delta \vDash \Phi' \to \Phi$, or equivalently, $\Theta ; \Delta, \Phi' \vDash \Phi$. Then by IH, $\Psi ; \Theta ; \Delta,\Phi' ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \tau$  Then, by T-CImpI, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |\Lambda .e| : (\Phi' \Rightarrow \tau)$ as required.
  \item[AT-CImpE] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \{\} \infers \tau \gens \Phi \wedge \Phi',\Gamma'$ from $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \infers (\Phi' \Rightarrow \tau) \gens \Phi,\Gamma'$ with $\Theta ; \Delta \vDash \Phi$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : (\Phi' \Rightarrow \tau)$. By T-CImpE, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e \{\}| : \tau$ as required.
  \item[AT-CAndI] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash <e> \checks \Phi' \amp \tau \gens \Phi \wedge \Phi',\Gamma'$ from $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \checks \tau \gens \Phi,\Gamma'$ with $\Theta ; \Delta \vDash \Phi$ and $\Theta ; \Delta \vDash \Phi'$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \tau$ By T-CAnd, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |<e>| : \Phi' \amp \tau$ as required.
  \item[AT-CAndE] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash \texttt{clet } x = e \texttt{ in } e' \checks \tau' \gens \Phi_1 \wedge (\Phi' \to \Phi_2),\Gamma_2 \setminus \{x : \tau\}$ from $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \infers \Phi' \amp \tau \gens \Phi_1,\Gamma_1$ and $\Psi ; \Theta ; \Delta, \Phi' ; \Omega ; \Gamma_1, x : \tau \vdash e' \checks \tau' \gens \Phi_2, \Gamma_2$ with $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta \vDash (\Phi' \to \Phi_2)$. By IH,
   $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma_1 \vdash |e| : \Phi' \amp \tau$. Since $\Theta; \Delta,\Phi' \vDash \Phi_2$, we have by IH that
   $\Psi ; \Theta ; \Delta, \Phi' ; \Omega ; (\Gamma_1, x : \tau) \setminus \Gamma_2 \vdash |e'| : \tau'$. By T-Weaken,
   $\Psi ; \Theta ; \Delta, \Phi' ; \Omega ; (\Gamma_1 \setminus (\Gamma_2 \setminus \{x : \tau\})), x : \tau\vdash |e'| : \tau'$, and so by T-CAndE and T-Weaken, 
   $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus (\Gamma_2 \setminus \{x : \tau\}) \vdash |\texttt{clet } x = e \texttt{ in } e'| : \tau'$ as required.
  
 
  \item[AT-Sub] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \checks \tau \gens \Phi_1 \wedge \Phi_2,\Gamma'$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \infers \tau' \gens \Phi_1,\Gamma'$ and $\Psi;\Theta;\Delta \vdash \tau' \subty \tau : \star \gens \Phi_2$ with $\Theta ; \Delta \vDash \Phi_1$ and $\Theta ; \Delta \vDash \Phi_2$. By IH,  $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \tau'$. By \textbf{Soundness of Subtyping}, $\Psi;\Theta;\Delta \vdash \tau' \subty \tau : \star$. Then, by T-Sub, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma\setminus \Gamma' \vdash |e| : \tau$ as required.
  
  
  \item[AT-Anno] Suppose $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash (e : \tau) \infers \tau \gens \Phi,\Gamma'$ by way of $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \vdash e \checks \tau \gens \Phi,\Gamma'$ with $\Theta ; \Delta \vDash \Phi$. By IH, $\Psi ; \Theta ; \Delta ; \Omega ; \Gamma \setminus \Gamma' \vdash |e| : \tau$. Then, because $|e| = |(e : \tau)|$, we are done.
   
\end{enumerate}
\end{proof}
